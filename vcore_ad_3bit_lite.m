%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%function vcore_ad_3bit_lite即单一矩阵向量乘模型
%a为权值矩阵输入，输入范围为[0,100]
%b为数据向量输入，输入范围为[0,511]
%s为模型数据
%函数返回值为做完乘法后的结果向量



%%此模型不考虑器件均匀性，假设全部均匀，输出AD精度为8位


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


function [o]=vcore_ad_3bit_lite(JZ,XL,ad)
s=[-100.358010346666,-99.5177759070416,-98.6355485478832,-97.7663670377754,-96.9072384176216,-96.0227025308019,-95.1813039844422,-94.3297514687595,-93.4277135383683,-92.5324725130176,-91.6609596404535,-90.7867242712718,-89.8957200910581,-88.9707926029019,-88.1365134540389,-87.1939536690999,-86.2592507622396,-85.2364650486400,-84.3289351229209,-83.3748231859595,-82.4151199917172,-81.4879255272579,-80.5384410540519,-79.5949335945964,-78.5765887248626,-77.5665178735129,-76.6235213851226,-75.6061420978391,-74.6067316182927,-73.6790066846636,-72.6535753228085,-71.6397635084779,-70.6290015673388,-69.6225917687962,-68.6691287210058,-67.6636248870629,-66.6064632238244,-65.5791640705882,-64.5065887845630,-63.5109369395556,-62.5827463625578,-61.5414711243642,-60.5506144104006,-59.4504659479743,-58.4849186696767,-57.4362756188609,-56.4304290607779,-55.4957812242592,-54.5129904525306,-53.5719826207383,-52.4525914667493,-51.5052195442343,-50.4955698944568,-49.4212624515836,-48.3952680949122,-47.3790844552309,-46.3770969705025,-45.3146098209865,-44.2596415796699,-43.2327355330839,-42.2304187463794,-41.2082589591543,-40.1523374547488,-39.1110151010089,-38.0665409223767,-36.9833080860845,-35.8843529589951,-34.8260158497958,-33.7359199485186,-32.6108555167313,-31.5472954730003,-30.5018299986730,-29.4314881964495,-28.3445915991762,-27.3395243419379,-26.3680969665989,-25.3309844233916,-24.3285174620105,-23.2818729500247,-22.2198029291215,-21.1565609758705,-20.0856517862311,-19.0918736616865,-18.0995428257677,-17.0709077903299,-16.0130569412016,-14.9002869184702,-13.8866540280684,-12.8362380671443,-11.7883723233057,-10.6988129222608,-9.62898035103159,-8.54586076493468,-7.44453353287695,-6.41496167533324,-5.37150951781702,-4.35816539408996,-3.25244502754966,-2.19034388663200,-1.03900184351360,0,1.02033416629504,2.09572604011174,3.08746556147983,4.15153185033955,5.24112017147031,6.34631077574304,7.39110591865119,8.40673025007879,9.43496399667980,10.3926895867858,11.4611336777599,12.6065851958621,13.5989413135583,14.7363330297981,15.7856651304049,16.8502256261400,17.8372224889782,18.8806708032455,19.9900267923562,21.0308651061098,22.0642062051499,23.0912767716373,24.1335411012443,25.1714882436611,26.1609946585947,27.1750461577439,28.2930649073419,29.3620623655477,30.4219385732451,31.4239143472526,32.5106124724120,33.5952274174850,34.6457838387550,35.7315610920862,36.7797682594142,37.7285069092172,38.7811099629589,39.7499532516985,40.8054326349639,41.8152321552122,42.8372296177498,43.8798442783021,44.9511125969364,45.9799810885767,47.0206773576080,48.0637888408544,49.0987082723131,50.0990778574011,51.1673389022592,52.1479736704249,53.1267170057393,54.1663166914839,55.1895489543186,56.2086428047017,57.1942973940535,58.2109809134772,59.1825511934660,60.1424569512463,61.1178378901892,62.0793230573478,63.1041301447438,64.0298195952701,65.0115376750621,66.0200387905985,66.9528893784633,67.9333529396697,68.9246168854131,69.9684779764107,70.9081986826332,71.8558838141837,72.8560839728171,73.8365822426089,74.7718860395371,75.7525311474765,76.7833755342097,77.7190211280474,78.6947954719778,79.6717685803951,80.5910386110777,81.5149715822746,82.4818791035653,83.5286691576027,84.4584266749861,85.4193891671752,86.3666741267359,87.2889622566732,88.2654770955783,89.2026928350647,90.1735003218725,91.1109260426032,92.0908822510287,92.9888179209758,93.9162829339293,94.8559738525375,95.8131770126969,96.7703801728562,97.7275833330156,98.6847864931749,99.6419896533342];
[~,n]=size(JZ);
JZ=s(101.+JZ);
c=[de2bi(XL),zeros(n,9-size(de2bi(XL),2))];
resultbit=JZ*c;
Min=8*n/2^(ad+1);
resultbit=fix(resultbit./(Min))*Min;
quanzhi=[1;2;4;8;16;32;64;128;256];
o=sum(resultbit*quanzhi,2);
end